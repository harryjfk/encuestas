@model List<Entity.Reportes.IVFMReport>
@using WebApplication.App_Code;
@{
    List<int> listMonths = ViewBag.listMonths;
}
<style>
    .table {
        white-space: nowrap;
    }

    th {
        text-align: center;
    }
</style>
<div class="table-responsive">
    <table id="tbl-ivf" class="table table-striped table-hover table-bordered table-condensed tabla small">
        <thead>
            <tr class="cabecera">
                <th>SECTOR - DIVISIÓN - GRUPO - CLASE</th>
                <th>ENE </th>
                <th>FEB </th>
                <th>MAR </th>
                <th>ABR </th>
                <th>MAY </th>
                <th>JUN </th>
                <th>JUL </th>
                <th>AGO </th>
                <th>SET </th>
                <th>OCT </th>
                <th>NOV </th>
                <th>DIC </th>
                <th>PROMEDIO</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
            <tr>
                <td>@Html.Raw(item.Texto)</td>
                <td>@item.Enero</td>
                <td>@item.Febrero</td>
                <td>@item.Marzo</td>
                <td>@item.Abril</td>
                <td>@item.Mayo</td>
                <td>@item.Junio</td>
                <td>@item.Julio</td>
                <td>@item.Agosto</td>
                <td>@item.Setiembre</td>
                <td>@item.Octubre</td>
                <td>@item.Noviembre</td>
                <td>@item.Diciembre</td>
                <td>
                    @*@(  String.Format("{0:0.00}",
                            (Static.getNumber(item.Enero) + Static.getNumber(item.Febrero) + Static.getNumber(item.Marzo)
                            + Static.getNumber(item.Abril) + Static.getNumber(item.Mayo) + Static.getNumber(item.Junio)
                            + Static.getNumber(item.Julio) + Static.getNumber(item.Agosto) + Static.getNumber(item.Setiembre)
                            + Static.getNumber(item.Octubre) + Static.getNumber(item.Noviembre) + Static.getNumber(item.Diciembre)) / 12)
                        )*@
                </td>
            </tr>
            }
        </tbody>
    </table>
</div>
<script>
    $(document).ready(function () {
        $('#tbl-ivf tr th:not(:nth-child(1))').css({ 'display': 'none' });
        $('#tbl-ivf tr td:not(:nth-child(1))').css({ 'display': 'none' });
        @foreach (var m in listMonths)
        {
            <text>
        $('#tbl-ivf tr th:nth-child(@(m + 1))').css({ 'display': '' });
        $('#tbl-ivf tr td:nth-child(@(m + 1))').css({ 'display': '' });
        $('#tbl-ivf tr td:nth-child(@(m + 1))').attr({ 'data-show': 'true' });
        </text>
        }
        //
        $('#tbl-ivf thead tr th:last-child').css({ 'display': '' });
        $('#tbl-ivf tbody tr td:last-child').css({ 'display': '' });
        setPromedio();
    });

    function setPromedio() {
        $('#tbl-ivf tbody tr').each(function () {
            var val = 0;
            $(this).find('td:not(:last-child)[data-show="true"]').each(function () {
                if (!isNaN($(this).text())) {
                    val = val + parseFloat($(this).text());
                }
            });
            $(this).find('td:last-child').html((val / $(this).find('td:not(:last-child)[data-show="true"]').length).toFixed(2));
        });
    }
</script>
