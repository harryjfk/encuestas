@model List<SelectListItem>
     @{
         Layout = "";
    }      
<div class="panel panel-default">
    <div class="panel-heading">Seleccione Factor</div>
    <div class="panel-body">
        @foreach (var item in Model)
        {
            if (item.Selected)
            {
                <div>
                    @Html.CheckBox(item.Text, new { @checked = "chequed", value = @item.Value, @class = "chfactor" })
                    <span>@item.Text</span>

                    @if (item.Value == "0")
                    {
                        <input type="text" id="otro_factor" value="@ViewBag.OtroFactor" class="animated fadeInLeft fast" />
                    }
                </div>
            }
            else
            {
                <div>
                    @Html.CheckBox(item.Text, new { value = @item.Value, @class = "chfactor" })
                    <span>@item.Text</span>

                    @if (item.Value == "0")
                    {
                        <input type="text" id="otro_factor" value="" class="animated fadeInLeft fast hidden" />
                    }
                </div>
            }
        }
    </div>
</div>

<script type="text/javascript">
    $(document).ready(function() {

        $('.chfactor').on('change',function() {
            var elem = (this);
            var id = elem.value;
            $.ajax({
                cache: false,
                type: "GET",
                url: window.location.origin + "/EncuestaEstadistica/SetFactorProduccion/",
                data: { id: id, put: elem.checked },
                success: function (data) {
                    //$("#divDecrecimiento").html(data);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert('Failed to retrieve data.');
                }
            });
        });

        $('#Otros').on('change', function () {            
            var elem = $(this);
            
            if (elem.prop("checked")) {
                $('#otro_factor').removeClass('hidden');
            } else {                
                $('#otro_factor').addClass('hidden');
                $('#otro_factor').change();
            }            
        });

        $('#otro_factor').change(function () {            
            var elem = $('#Otros');
            if (elem.prop("checked") == false) {
                $('#otro_factor').val('');
            }

            var otroFactorModel = {
                put: elem.prop("checked"),
                otroFactor: $(this).val()
            };

            $.ajax({
                url: window.location.origin + "/EncuestaEstadistica/SetOtroFactorProduccion/",
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(otroFactorModel),
                success: function (data) {
                    //$("#divDecrecimiento").html(data);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert('Failed to retrieve data.');
                }
            });            
        });
    });

</script>
